<!--左侧搜索表单-->
<form class="role-frm">
    <a class="backToList" ng-click="goBack()"><span class="glyphicon glyphicon-arrow-left"></span>&nbsp;返回列表</a>
    <div class="deviceTitle">编辑管理员</div>

    <hr class="hr-solid">
    <div>
        <img src="${base}/themes/default/images/circleRight.png" />
        <span class="fc6">
        	编辑管理员基本信息，至少绑定一张USB安全卡以及并分配一个角色和部门权限。
        </span>
    </div>
</form>
<!--右侧-->
<div class="admin-list">
    <div class="pwdDiv" style="position: absolute; left: 300px; top: 0px; bottom: 80px; overflow: auto; right: 0px;">
        <form name="addFrm" method="post" novalidate="novalidate">
	        <p class="editGroupDevice" style="font-size: 14px;">管理员基本信息</p>
			<p class="fc6" style="line-height: 30px;">管理员状态</p>
			<p>
				<input type="radio" id="start" style="margin-left: 2px;" ng-value="1" ng-model="status" class="rdo_1"  ng-checked="status==1" name="userState" >
				<label for="start"></label>
				<label for="start" class="curpos">启用</label>
				<input type="radio" id="stop" style="margin-left: 50px" ng-value="2" class="rdo_1" ng-model="status" ng-checked="status==2" name="userState">
				<label for="stop" ></label>
				<label for="stop" class="curpos">停用</label>
			</p>
	        <p class="fc6" style="line-height: 30px;">用户名</p>
	        <div ng-class="{'has-success':addFrm.userName.$valid, 'has-error':addFrm.userName.$invalid && addFrm.userName.$dirty}">
				<input ng-model="userName" ng-blur="blurCheck(addFrm.userName)" name="userName" class="form-control w350" required type="text" maxLength="20"
					ng-pattern="/^[^+?%#&=￥$]+$/"  tooltip="不能为空且不能包含特殊字符" tooltip-placement="bottom" ng-keyup="checkName()" ng-class="{'borderRed':checkuserName}"/>
	        </div>
	        <p class="fs12" style="color:red" ng-show="(addFrm.userName.$invalid && addFrm.userName.$dirty) || errorShow">{{addFrm.userName.$error.required?'用户名必填' :( addFrm.userName.$error.pattern?'用户名不能包含特殊字符':(checkuserName?'用户名已存在,请重新输入！':''))}}</p>
	        <p class="fc6" style="line-height: 30px;">真实姓名</p>
	        <div ng-class="{'has-success':addFrm.name.$valid, 'has-error':addFrm.name.$invalid && addFrm.name.$dirty}">
				<input ng-model="name" ng-blur="blurCheck(addFrm.name)" name="name" class="form-control w350" required type="text" maxLength="10" tooltip="不能为空" tooltip-placement="bottom"/>
			</div>
			<p class="fs12" style="color:red" ng-show="addFrm.name.$invalid && addFrm.name.$dirty">{{addFrm.name.$error.required?'真实姓名必填':''}}</p>
	        <p class="fc6" style="line-height: 30px;">手机号码</p>
	        <div ng-class="{'has-success':addFrm.mobile.$valid, 'has-error':addFrm.mobile.$invalid && addFrm.mobile.$dirty}">
				<input ng-model="mobile" ng-blur="blurCheck(addFrm.mobile)" name="mobile" class="form-control w350" required type="text" minLength ="11" maxLength="11"
					ng-pattern="/^1[3|4|5|7|8]\d{9}$/"  tooltip="不能为空" tooltip-placement="bottom"/>
			</div>
			<p class="fs12" style="color:red" ng-show="addFrm.mobile.$invalid && addFrm.mobile.$dirty">{{addFrm.mobile.$error.required?'手机号必填' : (addFrm.mobile.$error.pattern?'手机号格式不正确':'')}}</p>
	        <p class="fc6" style="line-height: 30px;">邮箱<span class="fc9">(选填)</span></p>
	        <div ng-class="{'has-success':addFrm.email.$valid, 'has-error':addFrm.email.$invalid}">
	            <input ng-model="email" ng-blur="blurCheck(addFrm.email)" name="email" class="form-control w350" type="text"
	            	ng-pattern="/^([a-zA-Z0-9_\.\-])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/" tooltip="允许为空" tooltip-placement="bottom"/>
	        </div>
	        <p class="fs12" style="color:red" ng-show="addFrm.email.$invalid">{{addFrm.email.$error.pattern?'邮箱格式不正确':''}}</p>
	        <p class="editGroupDevice" style="font-size: 14px;margin-top: 20px;">安全卡绑定</p>
	        <table class="thirdStepTable fc6">
	            <tr ng-repeat = "cardInfo in cardInfoRepeat">
	                <td style="padding-left: 0px;">卡号：<span ng-bind="cardInfo.cardId"></span></td>
	                <td>
						备注：
						<span ng-bind="(cardInfo.note=='null'||cardInfo.note=='undefined')?'':cardInfo.note" ng-show="{ true : 'false', false : 'true' }[editCardId==cardInfo.cardId]"></span>
						<input type="text" ng-model="cardInfo.note" ng-value="cardInfo.note" ng-show="{ true : 'true', false : 'false' }[editCardId==cardInfo.cardId]">
					</td>
	                <td ng-show="{ true : 'false', false : 'true' }[editCardId==cardInfo.cardId]">
						<a ng-click="editCardInfo(cardInfo)" class="desc-text">编辑</a>&nbsp;&nbsp;
						<a ng-click="unBindCard(cardInfo)" class="desc-text">解绑</a>
					</td>
					<td ng-show="{ true : 'true', false : 'false' }[editCardId==cardInfo.cardId]">
						<a ng-click="sureEdit(cardInfo)" class="desc-text">确定</a>&nbsp;&nbsp;
						<a ng-click="cancelEdit(cardInfo)" class="desc-text">取消</a>
					</td>
	            </tr>
	            <tr ng-show="addCard">
	                <td style="padding-right: 100px; padding-left: 0px;width: 400px;margin-right: 20px">
	                        <span class="float-left" style="margin-right: 10px;line-height: 34px">卡号:</span>
	                        <div class="input-group">
	                            <input type="text" ng-model="card.id" readonly="readonly" class="form-control float-left" style="width: 151%;">
	                           	<input type="hidden" ng-model="card.sn">
	                            <span class="input-group-addon" style="background-color: #3385ff; height: 35px; position: relative; left:40%;">
	                                <span style="color: #fff;" ng-click="readCard()">读卡</span>
	                            </span>
	                        </div>
	                </td>
	                <td style="padding-right: 60px;">
	                    <span class="float-left" style="line-height: 34px;" >备注：</span>
	                    <input type="text" class="form-control float-left" maxLength="200" ng-model="card.note" style="width:70%;">
	                </td>
	                <td>
	                    <input type="button" class="btn btn-green" value="绑卡" ng-click="bindCard()">
	                    <input ng-show="secondAdd && cardInfo" type="button" class="btn btn-gray" value="取消" ng-click="cancelBind()">
	                </td>
	            </tr>
	            <tr >
	                <td style="padding-left: 0px;">
	                    <a class="curpos" ng-click="editShow()">
	                        <span class="glyphicon glyphicon-plus"></span>
	                        <span>绑定更多USB卡</span>
	                    </a>
	                </td>
	            </tr>
	        </table>
	        <p class="editGroupDevice" style="font-size: 14px;margin-top: 20px">管理员权限</p>
	        <p class="fc6" style="line-height: 30px;">管理员角色</p>
	        <div class="adminRole">
	            <p style="border-bottom: 1px solid #cccccc;line-height: 34px">
	                <input type="checkbox"  id="checkAll" class="chk_1 strgChk"  ng-model="checkboxes.checked" ng-change="checkAll()" name="checkAll" autocomplete="off">
					<label for="checkAll" ng-class="{'checkStyle':checkboxes.checked}"></label>
					<label for="checkAll"  class="curpos">全选</label>
	            </p>
	            <div ng-repeat="role in rolesList" class="roleCheck">
	                <input type="checkbox" ng-model="role.selected" class="chk_1 userCheck" id="{{role.id}}" ng-change="roleSelect()">
					<label for="{{role.id}}" style="vertical-align: middle;line-height: 34px;" ng-class="{'checkStyle':role.selected}"></label>
					<label for="{{role.id}}" style="vertical-align: middle;font-weight: normal;width: 110px" class="curpos table-whitespace" title="{{role.name}}" ng-bind="role.name">
					</label>
	            </div>
	            <div class="clearfloat"></div>
	        </div>
	        <p class="fc6" style="line-height: 30px;">部门权限</p>
	        	<div class="leftDeptTree form-control authChoose" style="width: 650px;margin: 0px 0px 20px 0px;">
					<input type="hidden" ng-model="treectr1" name="treectr1" required>
						<div class="ztree">
							<div ivh-treeview="list"
				                 ivh-treeview-expand-to-depth="-1"
				                 ivh-treeview-id-attribute="'id'"
				                 ivh-treeview-label-attribute="'name'"
				                 ivh-treeview-children-attribute="'children'"
				                 ivh-treeview-use-checkboxes="true"
				                 ivh-treeview-twistie-collapsed-tpl="'<span class=\'button level0 switch center_close\'></span>'"
				                 ivh-treeview-twistie-expanded-tpl="'<span class=\'button level0 switch center_open\'></span>'"
				                 ivh-treeview-twistie-leaf-tpl="'<span class=\'button level1 switch center_docu\'></span>'"
				                 ivh-treeview-selected-attribute="'checked'"
				                 ivh-treeview-on-cb-change="selectCallback(ivhNode, ivhIsSelected, ivhTree)">
				            </div>
						</div>
				</div>
        </form>
    </div>
</div>
<div class="psdBtns">
    <button type="button" class="btn btn-gray" ng-click="goBack()">取消</button>
    <button type="button" class="btn btn-green" ng-click="saveManager()">保存管理员</button>
</div>

<section ng-show="alert.msg" style="position: absolute; top: 20px; left: 600px; right: 600px; z-index: 9999;">
	<div class="alert ng-scope ng-isolate-scope alert-dismissable" ng-class="['alert-' + (alert.type || 'warning'), alert.closeable ? 'alert-dismissable' : null]" role="alert">
		<button ng-show="alert.closeable" type="button" class="close" ng-click="alert=null" data-dismiss="alert" aria-label="close">
			<span aria-hidden="true">×</span>
		</button>
		<div>
			<span class="ng-scope ng-binding" ng-bind="alert.msg"></span></div>
	</div>
</section>